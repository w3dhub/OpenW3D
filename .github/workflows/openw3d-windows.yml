name: openw3d-windows

on: [push, pull_request]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  job:
    name: ${{ matrix.name }} Build
    runs-on: ${{ matrix.os }}
    timeout-minutes: 38
    strategy:
      fail-fast: false
      matrix:
        include:
          - name: windows-2022 Win32
            os: windows-2022
            arch: Win32
          - name: windows-2022 x64
            os: windows-2022
            arch: x64

    steps:
    - uses: actions/checkout@v4
      with:
        persist-credentials: false # do not persist auth token in the local git config
        path: main

    - name: 'run cmake'
      shell: pwsh
      run: |
        $THISDIR=Get-Location
        cd main
        cmake -A ${{ matrix.arch }} -B build .
        cmake --build build --parallel


